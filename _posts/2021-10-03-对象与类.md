---
layout: post
title: 对象与类
date: 2021-10-03
tags: JavaSE基础
---
## 1. 基本概念
类：构造对象的模版。  
对象：类的实例。  
对象中的数据：实例域。  
类之间的关系：  
1. 依赖：使用其他类。
2. 聚合：包含其他类。
3. 继承。

构造对象：

```java
Date d= new Date(); //注意区分，左边是变量，右边是对象，两者为引用关系。
```

另外：对象间赋值是传递引用，基本类型之间赋值是创建新的拷贝。基本的 == 比值，对象比引用是否相同。  
在Java中，任何对象变量的值都是对存储在另外一个地方的一个对象的引用。new操作符的返回值也是一个对新创建对象的引用。  
对象变量设置为null表示变量未引用，不能对null调用方法。  
只访问对象而不更改对象的方法为访问器方法，更改则为更改器方法。  
在一个源文件中只能有一个公有类，但可以有多个类（非公有）。文件名与public类名字匹配。  
一个类的例子：

```java
class student {
    private String name;
    private String id;
    private int avrscore;

    public student(String name1, String id1, int avrscore1) {
        name = name1;
        id = id1;
        avrscore = avrscore1;
    }

    public void show() {
        System.out.println(name + " " + id + " " + avrscore);
    }
}
```

一个方法可以访问所属类的所有对象的私有数据。  
final修饰成员变量表示该变量必须在构造前或构造时被初始化且以后不能再被改变。final修饰符大都应用于基本类型域或不可变域（String），否则只是表示对象引用不能再指示其他对象，而其本身可以被更改。  
Tips：
1. 构造器没有返回值。
2. 不要在构造器中定义与实例域重名的局部变量（会覆盖）。
3. 不要编写返回引用可变对象的访问器方法。

### 2. 静态域与静态方法
静态域：只属于类的域，所有对象共享。  

```java
private static int num=0;
```

未创建对象就已经被初始化。  
静态常量使用得比较多，特别是psf：

```java
public static final int num=1;
```

静态方法：一种不能向对象实施操作的方法，没有操作对象的方法。一般通过类名调用。  

```java
public static void getnum() {
    System.out.println(num);
}
```

静态方法不能访问实例域，但可以访问静态域。  
每个类都可以有一个自己的main方法，可以用来独立的测试那个类。

### 3. 方法参数
方法的参数调用永远按值调用，但调用对象时是创建了一个新变量，这个变量依旧引用实参引用的对象，方法得到的是对象引用的拷贝。调用int等基本类型就是直接另拷贝了一个新值。  
总结：
1. 一个方法不能修改一个基本数据类型的参数。
2. 一个方法可以改变一个对象参数的状态。
3. 一个方法不能让对象参数引用一个新的对象。 

### 4. 对象构造
允许对构造器及方法进行重载，方法的签名=方法名+参数类型。  
若实例域（和静态域）没被初始化，则会设为默认值（0，null，false等）。局部变量则必须初始化（使用前）。  
如果一个类没有构造器，系统会提供一个无参构造器，将所有实例域设为默认值。如果类中至少提供了一个构造器，则系统不会提供无参构造器。  
如果构造器的第一个语句形如this(...)， 这个构造器将调用同一个类的另一个构造器。且只能用一次。例如：

```java
public student{
    this("zy",18);
    avrscore=90;
}
```

除了构造器和声明赋值，还有第三种初始化方法，即初始化块:

```java
class student {
    private String name;
    private String id;
    private int avrscore;
    private static int num = 0;
    {
        name="default";
        id="000";
        avrscore=0;
        }
    }
```

在一个类的声明中，可以包含多个代码块。只要构造类的对象，这些块就会被执行。无论使用哪个构造器构造对象， 实例域都在对象初始化块中被初始化。首先运行初始化块，然后才运行构造器的主体部分。  
调用构造器的处理步骤：
1. 所有数据域被初始化为默认值（0、false 或null)。
2. 按照在类声明中出现的次序， 依次执行所有域初始化语句和初始化块。
3. 如果构造器第一行调用了第二个构造器， 则执行第二个构造器主体。
4. 执行这个构造器的主体。

可以使用静态初始化块来初始化静态域，只会在类第一次加载时初始化。  

```java
static
{
    num=1;
}
```

可以为任何一个类添加finalize方法，将在垃圾回收器清楚对象前调用。

### 5. 包
Java 允许使用包（package） 将类组织起来。借助于包可以方便地组织自己的代码，并将自己的代码与别人提供的代码库分开管理。  
包可以确保类名的唯一性。  
一个类可以使用所属包中的所有类以及其他包中的公有类（public class）。  
使用import可导入包。要想将一个类放入包中，就必须将包的名字放在源文件的开头。  
如：

```java
package com.javastudy.test;

/**
 * @author Zhang Yang
 * @description
 * @date 2020/12/28 - 11:17
 */
public class hello {
    public static void main(String[] args) {
        System.out.println("hello");
    }
}
```

如果没有在源文件中放置package 语句， 这个源文件中的类就被放置在一个默认包(defaulf package) 中。默认包是一个没有名字的包。  
包作用域：标记为public 的部分可以被任意的类使用；标记为private 的部分只能被定义它们的类使用；标记为protected可被子类及包内所有类访问。如果没有指定public 或private, 这个部分（类、方法或变量）可以被同一个包中的所有方法访问。  
另外在继承中包作用域的规则：
1. 父类的protected成员包内可见，且对子类可见。
2. 若子类与父类不在同一包中，那么在子类中，子类实例（方法）可以访问从父类继承的protected方法（属性），而不能访问父类实例的protected方法。
可参考链接[protected访问权限](https://www.cnblogs.com/liuleicode/p/4946248.html)。

### 6. 类设计技巧
1. 一定保证封装性，即数据私有。
2. 一定要对数据初始化。
3. 不要在类中使用过多的基本类型，用其他的类代替多个相关的基本类型的使用。
4. 不是所有的域都需要独立的域访问器和更改器。
5. 将职责过多的类进行分解。
6. 类名和方法名要能够体现它们的职责。
7. 优先使用不可变的类。

